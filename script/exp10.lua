#! /usr/bin/env lua

local K = {
  0;
  0;
  0;
  0; --4

0.001672444017262;
0.015249342049935;
0.044076813617021;
0.074639435086076;
0.09538700126631;
0.103602819601738;
0.101771201289688;
0.093676961099949;
0.082554318209052;
0.070617403241612;
0.059171084106257;
0.048870465022972;
0.03996031398685;
0.032450691579673;
0.026231839956328;
0.021143672584795;
0.0170149191029;
0.013683347901643;
0.011004815054612;
0.008856064086831;
0.007134264017858;
0.005755026067845;
0.004649869845166;
0.003763650541806;
0.003052193084221;

}

local function I(t, R0, R)
  if t >= 0 then
    if t <= 20 then
      return math.exp(0.2085 * (R0 - 1) * t)
    else
      return 520 * math.exp(0.2085 * (R - 1) * (t - 20))
    end
  else
    return 0
  end
end

local function J(t, R0, R)
  local v = 0
  for u = 3, 29 do
    v = v + I(t - u, R0, R) * K[u]
  end
  return v
end

for t = 0, 80 do
  local a = I(t, 2.5, 0.5)
  local b = I(t, 2.5, 0.875)
  local c = ""
  local d = ""
  if t >= 5 then
    c = J(t, 2.5, 0.5)
    d = J(t, 2.5, 0.875)
  end
  print(a, b, c, d)
end
